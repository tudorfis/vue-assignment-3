import { gridModel } from '../grid.model'
import { gridLinksOperations } from './gridLinks.operations' 

const cells1 = {"1-3":{"is":1,"type":"SEND_EMAIL","id":4},"2-1":{"is":1,"type":"SEND_SMS","id":8},"2-4":{"is":1,"type":"ADD_REMOVE_TAG","id":9},"3-2":{"is":1,"type":"AUTOMATION","id":0},"4-2":{"is":1,"type":"WAIT","id":15}}
const links1 = ["1-3__3-2","2-1__2-4","2-1__1-3","3-2__2-4","4-2__2-1","2-1__4-2","1-3__2-1","1-3__2-4"]
const paths1 = {"1-3__3-2":[{"a":0,"d":"M535.048 128 h-50 h-0 h-117 v117 v240 v35","color":"#6666FF","linkKey":"1-3__3-2"},{"a":1,"d":"M368 513.048 h14 l-14 18 l-14 -18 Z","color":"#6666FF","linkKey":"1-3__3-2"}],"2-1__2-4":[{"a":0,"d":"M195 368 h50 h480 h35","color":"#99E6E6","linkKey":"2-1__2-4"},{"a":1,"d":"M751.072 373 v-18 l18 14 l-18 14 Z","color":"#99E6E6","linkKey":"2-1__2-4"}],"2-1__1-3":[{"a":0,"d":"M195 354 h50 h240 h123 v-109 v-0 v-35","color":"#FF4D4D","linkKey":"2-1__1-3"},{"a":1,"d":"M608 223 h14 l-14 -18 l-14 18 Z","color":"#FF4D4D","linkKey":"2-1__1-3"}],"3-2__2-4":[{"a":0,"d":"M435.024 608 h50 h240 h123 v-123 v-0 v-35","color":"#4DB380","linkKey":"3-2__2-4"},{"a":1,"d":"M848 463.024 h14 l-14 -18 l-14 18 Z","color":"#4DB380","linkKey":"3-2__2-4"}],"4-2__2-1":[{"a":0,"d":"M295.024 848 h-50 h-0 h-117 v-117 v-240 v-35","color":"#E64D66","linkKey":"4-2__2-1"},{"a":1,"d":"M128 463.024 h14 l-14 -18 l-14 18 Z","color":"#E64D66","linkKey":"4-2__2-1"}],"2-1__4-2":[{"a":0,"d":"M195 382 h50 h0 h109 v109 v240 v35","color":"#9900B3","linkKey":"2-1__4-2"},{"a":1,"d":"M354 753.072 h14 l-14 18 l-14 -18 Z","color":"#9900B3","linkKey":"2-1__4-2"}],"1-3__2-1":[{"a":0,"d":"M535.048 114 h-50 h-240 h-117 v131 v0 v35","color":"#4D80CC","linkKey":"1-3__2-1"},{"a":1,"d":"M128 273.024 h14 l-14 18 l-14 -18 Z","color":"#4D80CC","linkKey":"1-3__2-1"}],"1-3__2-4":[{"a":0,"d":"M675.048 128 h50 h0 h123 v123 v0 v35","color":"#66E64D","linkKey":"1-3__2-4"},{"a":1,"d":"M848 273.024 h14 l-14 18 l-14 -18 Z","color":"#66E64D","linkKey":"1-3__2-4"}]}

const cells2 = {"1-3":{"is":1,"type":"SEND_EMAIL","id":4},"2-1":{"is":1,"type":"SEND_SMS","id":8},"2-4":{"is":1,"type":"ADD_REMOVE_TAG","id":9},"3-1":{"is":1,"type":"ADD_REMOVE_TAG","id":6},"3-2":{"is":1,"type":"AUTOMATION","id":0},"3-3":{"is":1,"type":"SUBSCRIBE_LIST","id":29},"4-2":{"is":1,"type":"WAIT","id":15},"5-3":{"is":1,"type":"AUTOMATION","id":66}}
const links2 = ["1-3__3-2","2-1__2-4","2-1__1-3","3-2__2-4","4-2__2-1","2-1__4-2","1-3__2-1","1-3__2-4","3-3__5-3","2-4__5-3","1-3__5-3","2-1__5-3","3-2__5-3","4-2__5-3","3-1__5-3","5-3__3-3"]
const paths2 = {"1-3__3-2":[{"a":0,"d":"M535.048 128 h-50 h-0 h-117 v117 v240 v35","color":"#6666FF","linkKey":"1-3__3-2"},{"a":1,"d":"M368 513.048 h14 l-14 18 l-14 -18 Z","color":"#6666FF","linkKey":"1-3__3-2"}],"2-1__2-4":[{"a":0,"d":"M195 368 h50 h480 h35","color":"#99E6E6","linkKey":"2-1__2-4"},{"a":1,"d":"M751.072 373 v-18 l18 14 l-18 14 Z","color":"#99E6E6","linkKey":"2-1__2-4"}],"2-1__1-3":[{"a":0,"d":"M195 354 h50 h240 h123 v-109 v-0 v-35","color":"#FF4D4D","linkKey":"2-1__1-3"},{"a":1,"d":"M608 223 h14 l-14 -18 l-14 18 Z","color":"#FF4D4D","linkKey":"2-1__1-3"}],"3-2__2-4":[{"a":0,"d":"M435.024 608 h50 h240 h123 v-123 v-0 v-35","color":"#4DB380","linkKey":"3-2__2-4"},{"a":1,"d":"M848 463.024 h14 l-14 -18 l-14 18 Z","color":"#4DB380","linkKey":"3-2__2-4"}],"4-2__2-1":[{"a":0,"d":"M295.024 848 h-50 h-0 h-117 v-117 v-240 v-35","color":"#E64D66","linkKey":"4-2__2-1"},{"a":1,"d":"M128 463.024 h14 l-14 -18 l-14 18 Z","color":"#E64D66","linkKey":"4-2__2-1"}],"2-1__4-2":[{"a":0,"d":"M195 382 h50 h0 h109 v109 v240 v35","color":"#9900B3","linkKey":"2-1__4-2"},{"a":1,"d":"M354 753.072 h14 l-14 18 l-14 -18 Z","color":"#9900B3","linkKey":"2-1__4-2"}],"1-3__2-1":[{"a":0,"d":"M535.048 114 h-50 h-240 h-117 v131 v0 v35","color":"#4D80CC","linkKey":"1-3__2-1"},{"a":1,"d":"M128 273.024 h14 l-14 18 l-14 -18 Z","color":"#4D80CC","linkKey":"1-3__2-1"}],"1-3__2-4":[{"a":0,"d":"M675.048 128 h50 h0 h123 v123 v0 v35","color":"#66E64D","linkKey":"1-3__2-4"},{"a":1,"d":"M848 273.024 h14 l-14 18 l-14 -18 Z","color":"#66E64D","linkKey":"1-3__2-4"}],"3-3__5-3":[{"a":0,"d":"M608 675.048 v50 v240 v35","color":"#CCCC00","linkKey":"3-3__5-3"},{"a":1,"d":"M608 993.096 h14 l-14 18 l-14 -18 Z","color":"#CCCC00","linkKey":"3-3__5-3"}],"2-4__5-3":[{"a":0,"d":"M775.072 354 h-50 h-0 h-131 v131 v480 v35","color":"#FF3380","linkKey":"2-4__5-3"},{"a":1,"d":"M594 993.096 h14 l-14 18 l-14 -18 Z","color":"#FF3380","linkKey":"2-4__5-3"}],"1-3__5-3":[{"a":0,"d":"M594 195 v50 v720 v35","color":"#999933","linkKey":"1-3__5-3"},{"a":1,"d":"M594 993.096 h14 l-14 18 l-14 -18 Z","color":"#999933","linkKey":"1-3__5-3"}],"2-1__5-3":[{"a":0,"d":"M195 340 h50 h240 h95 v151 v480 v35","color":"#1AFF33","linkKey":"2-1__5-3"},{"a":1,"d":"M580 993.096 h14 l-14 18 l-14 -18 Z","color":"#1AFF33","linkKey":"2-1__5-3"}],"3-2__5-3":[{"a":0,"d":"M368 675.048 v50 v240 v123 h123 h0 h35","color":"#E6FF80","linkKey":"3-2__5-3"},{"a":1,"d":"M511.048 1093 v-18 l18 14 l-18 14 Z","color":"#E6FF80","linkKey":"3-2__5-3"}],"4-2__5-3":[{"a":0,"d":"M435.024 848 h50 h0 h151 v123 v0 v35","color":"#809980","linkKey":"4-2__5-3"},{"a":1,"d":"M636 993.096 h14 l-14 18 l-14 -18 Z","color":"#809980","linkKey":"4-2__5-3"}],"3-1__5-3":[{"a":0,"d":"M114 675.048 v50 v240 v123 h123 h240 h35","color":"#4D8066","linkKey":"3-1__5-3"},{"a":1,"d":"M511.048 1093 v-18 l18 14 l-18 14 Z","color":"#4D8066","linkKey":"3-1__5-3"}],"5-3__3-3":[{"a":0,"d":"M566 1015.096 v-50 v-240 v-35","color":"#00E680","linkKey":"5-3__3-3"},{"a":1,"d":"M566 703.048 h14 l-14 -18 l-14 18 Z","color":"#00E680","linkKey":"5-3__3-3"}]}

const cells3 = {"1-2":{"is":1,"type":"SEND_SMS","id":97},"1-3":{"is":1,"type":"WAIT","id":90},"1-4":{"is":1,"type":"SPLIT","id":37},"1-6":{"is":1,"type":"GO_TO","id":14},"1-7":{"is":1,"type":"ADD_REMOVE_TAG","id":10},"2-5":{"is":1,"type":"SEND_EMAIL","id":31},"3-1":{"is":1,"type":"SEND_SMS","id":8},"3-4":{"is":1,"type":"ADD_REMOVE_TAG","id":6},"3-5":{"is":1,"type":"SUBSCRIBE_SEQUENCE","id":45},"3-10":{"is":1,"type":"AUTOMATION","id":66},"4-3":{"is":1,"type":"AUTOMATION","id":64},"4-6":{"is":1,"type":"SUBSCRIBE_LIST","id":29},"5-2":{"is":1,"type":"WAIT","id":15},"5-5":{"is":1,"type":"SUBSCRIBE_LIST","id":24},"6-1":{"is":1,"type":"SPLIT","id":86},"6-2":{"is":1,"type":"SUBSCRIBE_SEQUENCE","id":46},"6-5":{"is":1,"type":"GO_TO","id":43},"6-9":{"is":1,"type":"ADD_REMOVE_TAG","id":9},"7-1":{"is":1,"type":"SEND_SMS","id":46},"7-3":{"is":1,"type":"SEND_EMAIL","id":66},"7-8":{"is":1,"type":"SPLIT","id":88},"8-2":{"is":1,"type":"SEND_SMS","id":12},"8-4":{"is":1,"type":"GO_TO","id":46},"8-5":{"is":1,"type":"SPLIT","id":74},"8-6":{"is":1,"type":"ADD_REMOVE_TAG","id":101},"9-5":{"is":1,"type":"SUBSCRIBE_SEQUENCE","id":87},"9-8":{"is":1,"type":"SEND_EMAIL","id":4}}
const links3 = ["9-8__4-3","3-1__6-9","3-1__9-8","4-3__6-9","5-2__3-1","3-1__6-9","3-1__5-2","9-8__3-1","9-8__6-9","4-6__3-10","6-9__3-10","9-8__3-10","3-1__3-10","4-3__3-10","5-2__3-10","3-4__3-10","3-10__4-6","6-1__6-2","7-8__7-3","8-2__8-4","8-5__6-5","8-5__9-5","8-5__8-6","8-5__8-4","6-5__8-5","6-5__7-3","6-2__7-8","6-2__7-1","6-1__8-2","5-5__3-5","1-4__1-7","1-4__1-6","1-2__1-3","3-5__2-5","2-5__1-2","1-3__1-4"]
const paths3 = {"9-8__4-3":[{"a":0,"d":"M1735.168 2048 h-50 h-960 h-117 v-117 v-960 v-35","color":"#6666FF","linkKey":"9-8__4-3"},{"a":1,"d":"M608 943.072 h14 l-14 -18 l-14 18 Z","color":"#6666FF","linkKey":"9-8__4-3"}],"3-1__6-9":[{"a":0,"d":"M195 622 h50 h1680 h137 v109 v480 v35","color":"#99E6E6","linkKey":"3-1__6-9"},{"a":1,"d":"M2062 1233.12 h14 l-14 18 l-14 -18 Z","color":"#99E6E6","linkKey":"3-1__6-9"}],"3-1__9-8":[{"a":0,"d":"M195 594 h50 h1440 h123 v137 v1200 v35","color":"#FF4D4D","linkKey":"3-1__9-8"},{"a":1,"d":"M1808 1953.192 h14 l-14 18 l-14 -18 Z","color":"#FF4D4D","linkKey":"3-1__9-8"}],"4-3__6-9":[{"a":0,"d":"M675.048 848 h50 h1200 h109 v123 v240 v35","color":"#4DB380","linkKey":"4-3__6-9"},{"a":1,"d":"M2034 1233.12 h14 l-14 18 l-14 -18 Z","color":"#4DB380","linkKey":"4-3__6-9"}],"5-2__3-1":[{"a":0,"d":"M295.024 1088 h-50 h-0 h-117 v-117 v-240 v-35","color":"#E64D66","linkKey":"5-2__3-1"},{"a":1,"d":"M128 703.048 h14 l-14 -18 l-14 18 Z","color":"#E64D66","linkKey":"5-2__3-1"}],"3-1__5-2":[{"a":0,"d":"M195 580 h50 h0 h123 v151 v240 v35","color":"#9900B3","linkKey":"3-1__5-2"},{"a":1,"d":"M368 993.096 h14 l-14 18 l-14 -18 Z","color":"#9900B3","linkKey":"3-1__5-2"}],"9-8__3-1":[{"a":0,"d":"M1735.168 2034 h-50 h-1440 h-131 v-103 v-1200 v-35","color":"#4D80CC","linkKey":"9-8__3-1"},{"a":1,"d":"M114 703.048 h14 l-14 -18 l-14 18 Z","color":"#4D80CC","linkKey":"9-8__3-1"}],"9-8__6-9":[{"a":0,"d":"M1875.168 2048 h50 h0 h123 v-123 v-480 v-35","color":"#66E64D","linkKey":"9-8__6-9"},{"a":1,"d":"M2048 1423.12 h14 l-14 -18 l-14 18 Z","color":"#66E64D","linkKey":"9-8__6-9"}],"4-6__3-10":[{"a":0,"d":"M1395.12 834 h50 h720 h123 v-109 v-0 v-35","color":"#CCCC00","linkKey":"4-6__3-10"},{"a":1,"d":"M2288 703.048 h14 l-14 -18 l-14 18 Z","color":"#CCCC00","linkKey":"4-6__3-10"}],"6-9__3-10":[{"a":0,"d":"M2115.192 1328 h50 h0 h109 v-123 v-480 v-35","color":"#FF3380","linkKey":"6-9__3-10"},{"a":1,"d":"M2274 703.048 h14 l-14 -18 l-14 18 Z","color":"#FF3380","linkKey":"6-9__3-10"}],"9-8__3-10":[{"a":0,"d":"M1875.168 2034 h50 h240 h137 v-109 v-1200 v-35","color":"#999933","linkKey":"9-8__3-10"},{"a":1,"d":"M2302 703.048 h14 l-14 -18 l-14 18 Z","color":"#999933","linkKey":"9-8__3-10"}],"3-1__3-10":[{"a":0,"d":"M195 636 h50 h1920 h35","color":"#1AFF33","linkKey":"3-1__3-10"},{"a":1,"d":"M2191.216 641 v-18 l18 14 l-18 14 Z","color":"#1AFF33","linkKey":"3-1__3-10"}],"4-3__3-10":[{"a":0,"d":"M675.048 862 h50 h1440 h95 v-137 v-0 v-35","color":"#E6FF80","linkKey":"4-3__3-10"},{"a":1,"d":"M2260 703.048 h14 l-14 -18 l-14 18 Z","color":"#E6FF80","linkKey":"4-3__3-10"}],"5-2__3-10":[{"a":0,"d":"M435.024 1088 h50 h1680 h151 v-123 v-240 v-35","color":"#809980","linkKey":"5-2__3-10"},{"a":1,"d":"M2316 703.048 h14 l-14 -18 l-14 18 Z","color":"#809980","linkKey":"5-2__3-10"}],"3-4__3-10":[{"a":0,"d":"M915.072 608 h50 h1200 h35","color":"#4D8066","linkKey":"3-4__3-10"},{"a":1,"d":"M2191.216 613 v-18 l18 14 l-18 14 Z","color":"#4D8066","linkKey":"3-4__3-10"}],"3-10__4-6":[{"a":0,"d":"M2215.216 622 h-50 h-720 h-117 v103 v0 v35","color":"#00E680","linkKey":"3-10__4-6"},{"a":1,"d":"M1328 753.072 h14 l-14 18 l-14 -18 Z","color":"#00E680","linkKey":"3-10__4-6"}],"6-1__6-2":[{"a":0,"d":"M195 1328 h50 h0 h35","color":"#B3B31A","linkKey":"6-1__6-2"},{"a":1,"d":"M271.024 1333 v-18 l18 14 l-18 14 Z","color":"#B3B31A","linkKey":"6-1__6-2"}],"7-8__7-3":[{"a":0,"d":"M1735.168 1568 h-50 h-960 h-35","color":"#CC9999","linkKey":"7-8__7-3"},{"a":1,"d":"M700.048 1573 v-18 l-18 14 l18 14 Z","color":"#CC9999","linkKey":"7-8__7-3"}],"8-2__8-4":[{"a":0,"d":"M435.024 1808 h50 h240 h35","color":"#33991A","linkKey":"8-2__8-4"},{"a":1,"d":"M751.072 1813 v-18 l18 14 l-18 14 Z","color":"#33991A","linkKey":"8-2__8-4"}],"8-5__6-5":[{"a":0,"d":"M1088 1735.168 v-50 v-240 v-35","color":"#E666B3","linkKey":"8-5__6-5"},{"a":1,"d":"M1088 1423.12 h14 l-14 -18 l-14 18 Z","color":"#E666B3","linkKey":"8-5__6-5"}],"8-5__9-5":[{"a":0,"d":"M1088 1875.168 v50 v0 v35","color":"#1AB399","linkKey":"8-5__9-5"},{"a":1,"d":"M1088 1953.192 h14 l-14 18 l-14 -18 Z","color":"#1AB399","linkKey":"8-5__9-5"}],"8-5__8-6":[{"a":0,"d":"M1155.096 1808 h50 h0 h35","color":"#4DB3FF","linkKey":"8-5__8-6"},{"a":1,"d":"M1231.12 1813 v-18 l18 14 l-18 14 Z","color":"#4DB3FF","linkKey":"8-5__8-6"}],"8-5__8-4":[{"a":0,"d":"M1015.096 1808 h-50 h-0 h-35","color":"#E666FF","linkKey":"8-5__8-4"},{"a":1,"d":"M940.072 1813 v-18 l-18 14 l18 14 Z","color":"#E666FF","linkKey":"8-5__8-4"}],"6-5__8-5":[{"a":0,"d":"M1074 1395.12 v50 v240 v35","color":"#991AFF","linkKey":"6-5__8-5"},{"a":1,"d":"M1074 1713.168 h14 l-14 18 l-14 -18 Z","color":"#991AFF","linkKey":"6-5__8-5"}],"6-5__7-3":[{"a":0,"d":"M1015.096 1328 h-50 h-240 h-117 v117 v0 v35","color":"#66664D","linkKey":"6-5__7-3"},{"a":1,"d":"M608 1473.144 h14 l-14 18 l-14 -18 Z","color":"#66664D","linkKey":"6-5__7-3"}],"6-2__7-8":[{"a":0,"d":"M435.024 1328 h50 h1200 h109 v123 v0 v35","color":"#CC80CC","linkKey":"6-2__7-8"},{"a":1,"d":"M1794 1473.144 h14 l-14 18 l-14 -18 Z","color":"#CC80CC","linkKey":"6-2__7-8"}],"6-2__7-1":[{"a":0,"d":"M368 1395.12 v50 v0 v123 h-117 h-0 h-35","color":"#B33300","linkKey":"6-2__7-1"},{"a":1,"d":"M220 1573 v-18 l-18 14 l18 14 Z","color":"#B33300","linkKey":"6-2__7-1"}],"6-1__8-2":[{"a":0,"d":"M114 1395.12 v50 v240 v123 h123 h0 h35","color":"#4D8000","linkKey":"6-1__8-2"},{"a":1,"d":"M271.024 1813 v-18 l18 14 l-18 14 Z","color":"#4D8000","linkKey":"6-1__8-2"}],"5-5__3-5":[{"a":0,"d":"M1088 1015.096 v-50 v-240 v-35","color":"#B366CC","linkKey":"5-5__3-5"},{"a":1,"d":"M1088 703.048 h14 l-14 -18 l-14 18 Z","color":"#B366CC","linkKey":"5-5__3-5"}],"1-4__1-7":[{"a":0,"d":"M915.072 128 h50 h480 h35","color":"#66994D","linkKey":"1-4__1-7"},{"a":1,"d":"M1471.144 133 v-18 l18 14 l-18 14 Z","color":"#66994D","linkKey":"1-4__1-7"}],"1-4__1-6":[{"a":0,"d":"M915.072 114 h50 h240 h35","color":"#33FFCC","linkKey":"1-4__1-6"},{"a":1,"d":"M1231.12 119 v-18 l18 14 l-18 14 Z","color":"#33FFCC","linkKey":"1-4__1-6"}],"1-2__1-3":[{"a":0,"d":"M435.024 128 h50 h0 h35","color":"#E6331A","linkKey":"1-2__1-3"},{"a":1,"d":"M511.048 133 v-18 l18 14 l-18 14 Z","color":"#E6331A","linkKey":"1-2__1-3"}],"3-5__2-5":[{"a":0,"d":"M1088 535.048 v-50 v-0 v-35","color":"#FF1A66","linkKey":"3-5__2-5"},{"a":1,"d":"M1088 463.024 h14 l-14 -18 l-14 18 Z","color":"#FF1A66","linkKey":"3-5__2-5"}],"2-5__1-2":[{"a":0,"d":"M1015.096 368 h-50 h-480 h-117 v-117 v-0 v-35","color":"#CCFF1A","linkKey":"2-5__1-2"},{"a":1,"d":"M368 223 h14 l-14 -18 l-14 18 Z","color":"#CCFF1A","linkKey":"2-5__1-2"}],"1-3__1-4":[{"a":0,"d":"M675.048 128 h50 h0 h35","color":"#FF99E6","linkKey":"1-3__1-4"},{"a":1,"d":"M751.072 133 v-18 l18 14 l-18 14 Z","color":"#FF99E6","linkKey":"1-3__1-4"}]}

describe('gridLinksOperations', function () {
    test('constructor()', function () {
        expect(gridLinksOperations.colors).toEqual([])
        expect(gridLinksOperations.colorIds).toEqual([])
    })
    test('buildLinks()', function(){
        gridModel.model = { cells: cells1, links: links1 }
        gridModel.buildLinks()
        expect(gridModel.paths).toEqual(paths1)
    })
    test('buildLinks() - 1.2', function(){
        gridModel.model = { cells: cells2, links: links2 }
        gridModel.buildLinks()
        expect(gridModel.paths).toEqual(paths2)
    })
    test('buildLinks() - 1.3', function(){
        gridModel.model = { cells: cells3, links: links3 }
        gridModel.buildLinks()
        expect(gridModel.paths).toEqual(paths3)
    })
    test('hasNoLinks(position) - 1.1', function() {
        gridModel.model = { links: [...links1] }
        
        expect(gridModel.hasNoLinks('1-1')).toBe(true)
        expect(gridModel.hasNoLinks('1-2')).toBe(true)
        expect(gridModel.hasNoLinks('1-3')).toBe(false)
        expect(gridModel.hasNoLinks('1-4')).toBe(true)
        expect(gridModel.hasNoLinks('2-1')).toBe(false)
        expect(gridModel.hasNoLinks('2-2')).toBe(true)
        expect(gridModel.hasNoLinks('2-3')).toBe(true)
        expect(gridModel.hasNoLinks('2-4')).toBe(false)
        expect(gridModel.hasNoLinks('3-1')).toBe(true)
        expect(gridModel.hasNoLinks('3-2')).toBe(false)

        delete gridModel.model.links["3-2__2-4"]
        delete gridModel.model.links["1-3__2-4"]

        expect(gridModel.hasNoLinks('1-1')).toBe(true)
        expect(gridModel.hasNoLinks('1-2')).toBe(true)
        expect(gridModel.hasNoLinks('1-3')).toBe(false)
        expect(gridModel.hasNoLinks('1-4')).toBe(true)
    })
})